Homework 6
================
Na Yun CHo

``` r
library(tidyverse)
```

    ## -- Attaching packages ------------------------------------------------------------- tidyverse 1.3.0 --

    ## v ggplot2 3.3.2     v purrr   0.3.4
    ## v tibble  3.0.3     v dplyr   1.0.2
    ## v tidyr   1.1.2     v stringr 1.4.0
    ## v readr   1.3.1     v forcats 0.5.0

    ## -- Conflicts ---------------------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(modelr)
```

# Problem 2

### load data, propose a regression model

``` r
birthweight = read.csv("./data/Birthweight.csv") %>%
  mutate(babysex = as.factor(babysex),
         frace = as.factor(frace),
         malform = as.factor(malform),
         mrace = as.factor(mrace)) %>%
  drop_na()

model_1 = lm(bwt ~ delwt + ppbmi, data = birthweight)

birthweight %>% 
add_residuals(model_1) %>%
ggplot(aes(x = resid)) +
geom_density() +
labs(x = "residuals", title = "density plot of model residuals")
```

![](p8105_hw6_nc2894_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

``` r
birthweight %>%
add_residuals(model_1) %>%
add_predictions(model_1) %>%
ggplot(aes(x = resid, y = pred)) +
geom_point() +
labs(x = "residuals", y = "fitted values", title = "plot of model residuals against fitted values")
```

![](p8105_hw6_nc2894_files/figure-gfm/unnamed-chunk-2-2.png)<!-- -->
Comment on my model-building process: To propose a regression model for
birthweight, I decided to look at the factors of ‘delwt(mother’s weight
at delivery)’ and ‘ppbmi(mother’s pre-pregnancy bmi)’ based on previous
knowledge. I guessed that mother’s weight at delivery would be highly
associated with the baby’s birthweight and I have learned previously
that mother’s pre-pregnancy bmi could be associated with the baby’s
birthweight and future weights. To observe the distribution of the
residuals of this proposed regression model, I created a density plot of
the model residuals. The density plot showed a fairly normal-looking
distribution that may be slightly left skewed but there wasn’t extreme
skewness in the distribution. Thus, I proceeded to use this regression
model.

### compare models

``` r
model_2 = lm(bwt~ blength + gaweeks, data = birthweight)
model_3 = lm(bwt~ bhead * blength * babysex, data = birthweight)

cv_df1 = crossv_mc(birthweight, 2000) %>%
  mutate(
    train = map(train, as_tibble),
    test = map(test, as_tibble)
  )

cv_df2 = 
  cv_df1 %>%
  mutate( 
    model_1 = map(.x = train, ~lm(bwt ~ delwt + ppbmi, data = birthweight)),
    model_2 = map(.x = train, ~lm(bwt~ blength + gaweeks, data = birthweight)), 
    model_3 = map(.x = train, ~lm(bwt~ bhead * blength * babysex, data = birthweight))) %>%
  mutate(
    rmse_1 = map2_dbl(.x = model_1, .y = test, ~rmse(model = .x, data = .y)),
    rmse_2 = map2_dbl(.x = model_2, .y = test, ~rmse(model = .x, data = .y)),
    rmse_3 = map2_dbl(.x = model_3, .y = test, ~rmse(model = .x, data = .y)),
  )


cv_df2 %>% 
  select(starts_with("rmse")) %>%
  pivot_longer(
    everything(),
    names_to = "model",
    values_to = "rmse", 
    names_prefix = "rmse_") %>%
  ggplot(aes(x = model, y = rmse)) + 
  geom_violin()
```

![](p8105_hw6_nc2894_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->
From the violin plots, I can see that the third model is the best
regression model because it has the lowest rmse values than the other
two models. The third model is the one using head circumference, length,
sex, and all their interactions.
